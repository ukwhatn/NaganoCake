<div class="col-12 col-lg-10 offset-lg-1">
  <div class="d-flex justify-content-between align-items-center">
    <h4 class="d-inline-block bg-light px-3 py-2">
      ショッピングカート
    </h4>
    <%= link_to destroy_all_cart_items_path, class: "btn btn-danger px-4 py-2" do %>
      <i class="fa-solid fa-trash"></i> カートを空にする
    <% end %>
  </div>
  <table class="table-bordered w-100">
    <thead class="bg-light">
    <tr>
      <th class="p-2">
        商品名
      </th>
      <th class="p-2">
        単価(税込)
      </th>
      <th class="p-2">
        数量
      </th>
      <th>
      </th>
    </tr>
    </thead>
    <tbody>
    <% @cart_items.each do |cart_item| %>
      <tr>
        <td class="p-2">
          <%= image_tag cart_item.item.get_image("100x100"), class: "d-inline-block pr-3" %>
          <%= link_to cart_item.item.name, item_path(cart_item.item), class:"font-weight-bold text-body" %>
        </td>
        <td class="p-2">
          <%= cart_item.item.with_tax_price %>
        </td>
        <td class="p-2">
          <%= form_with model: cart_item, url: cart_item_path(cart_item) do |f| %>
            <div class="input-group">
              <%= f.select :amount, (1..10), {}, { class: "form-control" } %>
              <div class="input-group-append">
                <%= f.submit "変更", class: "btn btn-success" %>
              </div>
            </div>
          <% end %>
        </td>
        <td class="p-2">
          <%= link_to "削除する",
                      cart_item_path(cart_item),
                      method: :delete,
                      class: "btn btn-danger d-block",
                      data: { confirm: "削除してもよろしいですか？" }
          %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
  <div class="d-flex justify-content-between align-items-center my-5">
    <%= link_to "買い物を続ける", items_path, class: "btn btn-primary" %>
    <table class="table-bordered">
      <tr>
        <th class="bg-light px-5 py-2">
          合計金額
        </th>
        <td class="px-5 py-2">
          <%= @cart_items.sum(&:subtotal) %>円
        </td>
      </tr>
    </table>
  </div>
  <div class="d-flex justify-content-center align-items-center">
    <%= link_to "情報入力に進む", new_order_path, class: "btn btn-success px-5 py-2 font-weight-bold" %>
  </div>
</div>